import CodeBlock from '@theme/CodeBlock';

import customField from '@site/src/libs/customField';

{/* ------------------------------------------------------------------------ */}

This page is intended for those who want to build the xPack OpenOCD
binaries themselves.

## The xPack Build Box

The build scripts in this project use the **xPack Build Box** (**XBB**)
tools, which require the usual native development tools
(packed as a Docker image for GNU/Linux builds), complemented with
several binary xPacks, installed with `xpm` as development dependencies.

For those interested in understanding how things work, a good starting point
would be to read the [XBB](https://xpack.github.io/xbb/) page.

:::caution

The XBB tools are intended for building standalone relocatable distributions,
thus are quite complex and perform several post-processing steps to
adjust RPATH and validate the resulting binaries.

For the traditional `configure && make install` builds specific to Linux,
these scripts are probably too complicated and thus are not recommended
for inexperienced users.

:::

## Prerequisites

The build scripts run on GNU/Linux and macOS. The Windows binaries are
generated on Intel GNU/Linux, using [mingw-w64](https://mingw-w64.org).

For details on installing the prerequisites, please read the
[XBB prerequisites page](https://xpack.github.io/xbb/prerequisites/).

## Get project sources

The project is hosted on GitHub:

<ul>
<li><a href={ `https://github.com/xpack-dev-tools/${ customField('appLcName') }-xpack.git` }>{ `https://github.com/xpack-dev-tools/${ customField('appLcName') }-xpack.git` }</a></li>
</ul>

To clone the stable branch (`xpack`), run the following commands in a
terminal (on Windows use the _Git Bash_ console):

<CodeBlock language="sh"> {
`rm -rf ~/Work/xpack-dev-tools/${ customField('appLcName') }-xpack.git && \\
git clone https://github.com/xpack-dev-tools/${ customField('appLcName') }-xpack.git \\
  ~/Work/xpack-dev-tools/${ customField('appLcName') }-xpack.git`
}</CodeBlock>

For development purposes, clone the `xpack-develop` branch:

<CodeBlock language="sh"> {
`rm -rf ~/Work/xpack-dev-tools/${ customField('appLcName') }-xpack.git && \\
mkdir -p ~/Work/xpack-dev-tools && \\
git clone \\
  --branch xpack-develop \\
  https://github.com/xpack-dev-tools/${ customField('appLcName') }-xpack.git \\
  ~/Work/xpack-dev-tools/${ customField('appLcName') }-xpack.git`
}</CodeBlock>

## Get helper sources (optional, for development purposes)

The project has a dependency to a common **helper**, that is
normally installed as a read-only dependency; **for development
purposes**, to be able to make changes to the scripts located in the helper,
clone the `xpack-develop` branch and link it to the central
xPacks store:

```sh
rm -rf ~/Work/xpack-dev-tools/xbb-helper-xpack.git && \
mkdir -p ~/Work/xpack-dev-tools && \
git clone \
  --branch xpack-develop \
  https://github.com/xpack-dev-tools/xbb-helper-xpack.git \
  ~/Work/xpack-dev-tools/xbb-helper-xpack.git && \
xpm link -C ~/Work/xpack-dev-tools/xbb-helper-xpack.git
```

For more details the how a writeable helper can be used via
`xpm link`, please see the
[XBB](https://xpack.github.io/xbb/#writable-helper-scripts) documentation.

